---
source: bench/tests/plans/bsbm_business_intelligence.rs
expression: "&string"
---
ProjectionExec: expr=[ENC_PT(product@0) as product, ENC_PT(ratio@3) as ratio]
  SortExec: TopK(fetch=10), expr=[ENC_SORT(DIV(xsd:float(monthCount@1), monthBeforeCount@2)) DESC, ENC_SORT(ENC_PT(product@0)) ASC], preserve_partitioning=[false]
    ProjectionExec: expr=[product@0 as product, monthCount@1 as monthCount, monthBeforeCount@2 as monthBeforeCount, DIV(xsd:float(monthCount@1), monthBeforeCount@2) as ratio]
      CoalesceBatchesExec: target_batch_size=8192
        HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(product@0, product@0)], projection=[product@0, monthCount@1, monthBeforeCount@3]
          ProjectionExec: expr=[product@0 as product, INT64_AS_TERM(<uuid>@1) as monthCount]
            AggregateExec: mode=Single, gby=[product@1 as product], aggr=[<uuid>]
              CoalesceBatchesExec: target_batch_size=8192
                FilterExec: EBV(BOOLEAN_AS_TERM(EBV(GEQ(ENC_TV(date@2), ENC_TV({term_type:2,value:2007-10-10,data_type:http://www.w3.org/2001/XMLSchema#date,language_tag:}))) AND EBV(LT(ENC_TV(date@2), ENC_TV({term_type:2,value:2007-11-07,data_type:http://www.w3.org/2001/XMLSchema#date,language_tag:})))))
                  CoalesceBatchesExec: target_batch_size=8192
                    HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(review@0, review@0)], projection=[review@0, product@1, date@3]
                      DataSourceExec: [GPOS] subject=?review, predicate=<http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/reviewFor>, object=?product
                      DataSourceExec: [GPOS] subject=?review, predicate=<http://purl.org/dc/elements/1.1/date>, object=?date, additional_filters=[DynamicFilterPhysicalExpr [ true ]]
          ProjectionExec: expr=[product@0 as product, <uuid>@1 as monthBeforeCount]
            CoalesceBatchesExec: target_batch_size=8192
              FilterExec: EBV(GT(<uuid>@1, ENC_TV({term_type:2,value:0,data_type:http://www.w3.org/2001/XMLSchema#integer,language_tag:})))
                ProjectionExec: expr=[product@0 as product, INT64_AS_TERM(<uuid>@1) as <uuid>]
                  AggregateExec: mode=Single, gby=[product@1 as product], aggr=[<uuid>]
                    CoalesceBatchesExec: target_batch_size=8192
                      FilterExec: EBV(BOOLEAN_AS_TERM(EBV(GEQ(ENC_TV(date@2), ENC_TV({term_type:2,value:2007-09-12,data_type:http://www.w3.org/2001/XMLSchema#date,language_tag:}))) AND EBV(LT(ENC_TV(date@2), ENC_TV({term_type:2,value:2007-10-10,data_type:http://www.w3.org/2001/XMLSchema#date,language_tag:})))))
                        CoalesceBatchesExec: target_batch_size=8192
                          HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(review@0, review@0)], projection=[review@0, product@1, date@3]
                            DataSourceExec: [GPOS] subject=?review, predicate=<http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/reviewFor>, object=?product
                            DataSourceExec: [GPOS] subject=?review, predicate=<http://purl.org/dc/elements/1.1/date>, object=?date, additional_filters=[DynamicFilterPhysicalExpr [ true ]]
