---
source: bench/tests/plans/bsbm_business_intelligence.rs
expression: "&explanation.optimized_logical_plan.to_string()"
---
Projection: ENC_PT(product) AS product, ENC_PT(ratio) AS ratio
  Limit: skip=0, fetch=10
    Projection: product, ratio
      Sort: ENC_SORT(DIV(xsd:float(monthCount), monthBeforeCount)) DESC NULLS FIRST, ENC_SORT(ENC_PT(product)) ASC NULLS FIRST
        Projection: product, monthCount, monthBeforeCount, DIV(xsd:float(monthCount), monthBeforeCount) AS ratio
          Projection: lhs.product AS product, lhs.monthCount AS monthCount, rhs.monthBeforeCount AS monthBeforeCount
            Inner Join: lhs.product = rhs.product
              SubqueryAlias: lhs
                Projection: product, monthCount
                  Projection: product, <uuid>, <uuid> AS monthCount
                    Projection: product, INT64_AS_TERM(<uuid>) AS <uuid>
                      Aggregate: groupBy=[[product AS product]], aggr=[[count(review) AS <uuid>]]
                        Filter: EBV(BOOLEAN_AS_TERM(EBV(GEQ(ENC_TV(date), ENC_TV(Struct({term_type:2,value:2007-10-10,data_type:http://www.w3.org/2001/XMLSchema#date,language_tag:})))) AND EBV(LT(ENC_TV(date), ENC_TV(Struct({term_type:2,value:2007-11-07,data_type:http://www.w3.org/2001/XMLSchema#date,language_tag:}))))))
                          Projection: lhs.review AS review, lhs.product AS product, rhs.date AS date
                            Inner Join: lhs.review = rhs.review
                              SubqueryAlias: lhs
                                QuadPattern (?review <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/reviewFor> ?product)
                              SubqueryAlias: rhs
                                QuadPattern (?review <http://purl.org/dc/elements/1.1/date> ?date)
              SubqueryAlias: rhs
                Projection: product, monthBeforeCount
                  Projection: product, <uuid>, <uuid> AS monthBeforeCount
                    Filter: EBV(GT(<uuid>, ENC_TV(Struct({term_type:2,value:0,data_type:http://www.w3.org/2001/XMLSchema#integer,language_tag:}))))
                      Projection: product, INT64_AS_TERM(<uuid>) AS <uuid>
                        Aggregate: groupBy=[[product AS product]], aggr=[[count(review) AS <uuid>]]
                          Filter: EBV(BOOLEAN_AS_TERM(EBV(GEQ(ENC_TV(date), ENC_TV(Struct({term_type:2,value:2007-09-12,data_type:http://www.w3.org/2001/XMLSchema#date,language_tag:})))) AND EBV(LT(ENC_TV(date), ENC_TV(Struct({term_type:2,value:2007-10-10,data_type:http://www.w3.org/2001/XMLSchema#date,language_tag:}))))))
                            Projection: lhs.review AS review, lhs.product AS product, rhs.date AS date
                              Inner Join: lhs.review = rhs.review
                                SubqueryAlias: lhs
                                  QuadPattern (?review <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/reviewFor> ?product)
                                SubqueryAlias: rhs
                                  QuadPattern (?review <http://purl.org/dc/elements/1.1/date> ?date)
