---
source: bench/tests/plans/bsbm_business_intelligence.rs
expression: canonicalize_uuids(&explanation.initial_logical_plan.to_string())
---
Projection: country AS country, ENV_PT(product) AS product, ENV_PT(nrOfReviews) AS nrOfReviews, ENV_PT(avgPrice) AS avgPrice
  Projection: country, product, nrOfReviews, avgPrice
    Sort: ENV_SORT(nrOfReviews) DESC NULLS FIRST, ENV_SORT(country) ASC NULLS FIRST, ENV_SORT(ENV_PT(product)) ASC NULLS FIRST
      Filter: EBV(EQ(nrOfReviews, maxReviews))
        SparqlJoin: Inner 
          Projection: country AS country, maxReviews, product, avgPrice
            SparqlJoin: Inner 
              Projection: ENV_PT(country) AS country, maxReviews
                Projection: country, maxReviews
                  Extend: ?maxReviews 00000000000000000000000000000001
                    Projection: country, 00000000000000000000000000000001
                      Aggregate: groupBy=[[country AS country]], aggr=[[MAX(nrOfReviews) AS 00000000000000000000000000000001]]
                        Projection: country, product, nrOfReviews
                          Extend: ?nrOfReviews 00000000000000000000000000000002
                            Projection: country, product, enc_int64_as_rdf_term(00000000000000000000000000000002) AS 00000000000000000000000000000002
                              Aggregate: groupBy=[[country AS country, product AS product]], aggr=[[count(review) AS 00000000000000000000000000000002]]
                                SparqlJoin: Inner 
                                  SparqlJoin: Inner 
                                    SparqlJoin: Inner 
                                      QuadPattern (?product <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/instances/ProductType111>), active_graph: Union of [DefaultGraph] 
                                      QuadPattern (?review <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/reviewFor> ?product), active_graph: Union of [DefaultGraph] 
                                    QuadPattern (?review <http://purl.org/stuff/rev#reviewer> ?reviewer), active_graph: Union of [DefaultGraph] 
                                  QuadPattern (?reviewer <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/country> ?country), active_graph: Union of [DefaultGraph] 
              Projection: country AS country, product, avgPrice
                Projection: country, product, avgPrice
                  Extend: ?avgPrice 00000000000000000000000000000003
                    Projection: country, product, 00000000000000000000000000000003
                      Aggregate: groupBy=[[Struct({term_type:,value:,data_type:,language_tag:}) AS country, product AS product]], aggr=[[AVG(xsd:float(xsd:boolean(ENC_TV(price)))) AS 00000000000000000000000000000003]]
                        SparqlJoin: Inner 
                          SparqlJoin: Inner 
                            QuadPattern (?product <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/instances/ProductType111>), active_graph: Union of [DefaultGraph] 
                            QuadPattern (?offer <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/product> ?product), active_graph: Union of [DefaultGraph] 
                          QuadPattern (?offer <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/price> ?price), active_graph: Union of [DefaultGraph] 
          Projection: ENV_PT(country) AS country, product, nrOfReviews
            Projection: country, product, nrOfReviews
              Extend: ?nrOfReviews 00000000000000000000000000000004
                Projection: country, product, enc_int64_as_rdf_term(00000000000000000000000000000004) AS 00000000000000000000000000000004
                  Aggregate: groupBy=[[country AS country, product AS product]], aggr=[[count(review) AS 00000000000000000000000000000004]]
                    SparqlJoin: Inner 
                      SparqlJoin: Inner 
                        SparqlJoin: Inner 
                          QuadPattern (?product <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/instances/ProductType111>), active_graph: Union of [DefaultGraph] 
                          QuadPattern (?review <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/reviewFor> ?product), active_graph: Union of [DefaultGraph] 
                        QuadPattern (?review <http://purl.org/stuff/rev#reviewer> ?reviewer), active_graph: Union of [DefaultGraph] 
                      QuadPattern (?reviewer <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/country> ?country), active_graph: Union of [DefaultGraph]
