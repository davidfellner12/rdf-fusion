---
source: bench/tests/plans/bsbm_business_intelligence.rs
expression: canonicalize_uuids(&explanation.initial_logical_plan.to_string())
---
Projection: ENC_PT(product) AS product, ENC_PT(ratio) AS ratio
  Limit: skip=0, fetch=10
    Projection: product, ratio
      Sort: ENC_SORT(DIV(xsd:float(monthCount), monthBeforeCount)) DESC NULLS FIRST, ENC_SORT(ENC_PT(product)) ASC NULLS FIRST
        Extend: ?ratio DIV(xsd:float(monthCount), monthBeforeCount)
          SparqlJoin: Inner 
            Projection: product, monthCount
              Extend: ?monthCount 00000000000000000000000000000001
                Projection: product, enc_int64_as_rdf_term(00000000000000000000000000000001) AS 00000000000000000000000000000001
                  Aggregate: groupBy=[[product AS product]], aggr=[[count(review) AS 00000000000000000000000000000001]]
                    Filter: EBV(BOOLEAN_AS_TERM(coalesce(EBV(GEQ(ENC_TV(date), ENC_TV(Struct({term_type:2,value:2007-10-10,data_type:http://www.w3.org/2001/XMLSchema#date,language_tag:})))), Boolean(false)) AND coalesce(EBV(LT(ENC_TV(date), ENC_TV(Struct({term_type:2,value:2007-11-07,data_type:http://www.w3.org/2001/XMLSchema#date,language_tag:})))), Boolean(false))))
                      SparqlJoin: Inner 
                        QuadPattern (?review <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/reviewFor> ?product), active_graph: Union of [DefaultGraph] 
                        QuadPattern (?review <http://purl.org/dc/elements/1.1/date> ?date), active_graph: Union of [DefaultGraph] 
            Projection: product, monthBeforeCount
              Extend: ?monthBeforeCount 00000000000000000000000000000002
                Filter: EBV(GT(00000000000000000000000000000002, ENC_TV(Struct({term_type:2,value:0,data_type:http://www.w3.org/2001/XMLSchema#integer,language_tag:}))))
                  Projection: product, enc_int64_as_rdf_term(00000000000000000000000000000002) AS 00000000000000000000000000000002
                    Aggregate: groupBy=[[product AS product]], aggr=[[count(review) AS 00000000000000000000000000000002]]
                      Filter: EBV(BOOLEAN_AS_TERM(coalesce(EBV(GEQ(ENC_TV(date), ENC_TV(Struct({term_type:2,value:2007-09-12,data_type:http://www.w3.org/2001/XMLSchema#date,language_tag:})))), Boolean(false)) AND coalesce(EBV(LT(ENC_TV(date), ENC_TV(Struct({term_type:2,value:2007-10-10,data_type:http://www.w3.org/2001/XMLSchema#date,language_tag:})))), Boolean(false))))
                        SparqlJoin: Inner 
                          QuadPattern (?review <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/reviewFor> ?product), active_graph: Union of [DefaultGraph] 
                          QuadPattern (?review <http://purl.org/dc/elements/1.1/date> ?date), active_graph: Union of [DefaultGraph]
