---
source: bench/tests/plans/bsbm_business_intelligence.rs
expression: "&explanation.optimized_logical_plan.to_string()"
---
Projection: ENC_PT(vendor) AS vendor, ENC_PT(cheapExpensiveRatio) AS cheapExpensiveRatio
  Limit: skip=0, fetch=10
    Projection: vendor, cheapExpensiveRatio
      Sort: ENC_SORT(DIV(xsd:float(belowAvg), offerCount)) DESC NULLS FIRST, ENC_SORT(ENC_PT(vendor)) ASC NULLS FIRST
        Projection: vendor, belowAvg, offerCount, DIV(xsd:float(belowAvg), offerCount) AS cheapExpensiveRatio
          Projection: lhs.vendor AS vendor, lhs.belowAvg AS belowAvg, rhs.offerCount AS offerCount
            Inner Join: lhs.vendor = rhs.vendor
              SubqueryAlias: lhs
                Projection: vendor, belowAvg
                  Projection: vendor, <uuid>, <uuid> AS belowAvg
                    Projection: vendor, INT64_AS_TERM(<uuid>) AS <uuid>
                      Aggregate: groupBy=[[vendor AS vendor]], aggr=[[count(offer) AS <uuid>]]
                        Filter: EBV(LT(xsd:float(xsd:string(ENC_TV(price))), avgPrice))
                          Projection: lhs.product AS product, lhs.offer AS offer, lhs.vendor AS vendor, lhs.price AS price, rhs.avgPrice AS avgPrice
                            Inner Join: lhs.product = rhs.product
                              SubqueryAlias: lhs
                                Projection: lhs.product AS product, lhs.offer AS offer, lhs.vendor AS vendor, rhs.price AS price
                                  Inner Join: lhs.offer = rhs.offer
                                    SubqueryAlias: lhs
                                      Projection: lhs.product AS product, lhs.offer AS offer, rhs.vendor AS vendor
                                        Inner Join: lhs.offer = rhs.offer
                                          SubqueryAlias: lhs
                                            Projection: lhs.product AS product, rhs.offer AS offer
                                              Inner Join: lhs.product = rhs.product
                                                SubqueryAlias: lhs
                                                  QuadPattern (?product <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/instances/ProductType4>)
                                                SubqueryAlias: rhs
                                                  QuadPattern (?offer <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/product> ?product)
                                          SubqueryAlias: rhs
                                            QuadPattern (?offer <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/vendor> ?vendor)
                                    SubqueryAlias: rhs
                                      QuadPattern (?offer <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/price> ?price)
                              SubqueryAlias: rhs
                                Projection: product, avgPrice
                                  Projection: product, <uuid>, <uuid> AS avgPrice
                                    Projection: product, <uuid>
                                      Aggregate: groupBy=[[product AS product]], aggr=[[AVG(xsd:float(xsd:string(ENC_TV(price)))) AS <uuid>]]
                                        Projection: lhs.product AS product, lhs.offer AS offer, lhs.vendor AS vendor, rhs.price AS price
                                          Inner Join: lhs.offer = rhs.offer
                                            SubqueryAlias: lhs
                                              Projection: lhs.product AS product, lhs.offer AS offer, rhs.vendor AS vendor
                                                Inner Join: lhs.offer = rhs.offer
                                                  SubqueryAlias: lhs
                                                    Projection: lhs.product AS product, rhs.offer AS offer
                                                      Inner Join: lhs.product = rhs.product
                                                        SubqueryAlias: lhs
                                                          QuadPattern (?product <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/instances/ProductType4>)
                                                        SubqueryAlias: rhs
                                                          QuadPattern (?offer <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/product> ?product)
                                                  SubqueryAlias: rhs
                                                    QuadPattern (?offer <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/vendor> ?vendor)
                                            SubqueryAlias: rhs
                                              QuadPattern (?offer <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/price> ?price)
              SubqueryAlias: rhs
                Projection: vendor, offerCount
                  Projection: vendor, <uuid>, <uuid> AS offerCount
                    Projection: vendor, INT64_AS_TERM(<uuid>) AS <uuid>
                      Aggregate: groupBy=[[vendor AS vendor]], aggr=[[count(offer) AS <uuid>]]
                        Projection: lhs.product AS product, lhs.offer AS offer, rhs.vendor AS vendor
                          Inner Join: lhs.offer = rhs.offer
                            SubqueryAlias: lhs
                              Projection: lhs.product AS product, rhs.offer AS offer
                                Inner Join: lhs.product = rhs.product
                                  SubqueryAlias: lhs
                                    QuadPattern (?product <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/instances/ProductType4>)
                                  SubqueryAlias: rhs
                                    QuadPattern (?offer <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/product> ?product)
                            SubqueryAlias: rhs
                              QuadPattern (?offer <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/vendor> ?vendor)
